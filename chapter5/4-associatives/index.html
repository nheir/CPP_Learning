<!doctype html><html lang=fr dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 7.0.1+72a875f1db967152c77914cff4d53f8fcee0e619"><meta name=description content="Un conteneur associatif est un conteneur dans lequel les √©l√©ments peuvent √™tre index√©s par des objets, et non plus seulement par des entiers.
Vous allez donc ici voir les diff√©rents types de conteneurs associatifs propos√©s par la STL.
Pour cet exercice, vous modifierez les fichiers :
- chap-05/3-associatives/main.cpp
- chap-05/3-associatives/keys.h
La cible √† compiler est c5-3-associatives.
Les sets (ensembles) Un set est un conteneur dans lequel les √©l√©ments sont ‚Äúindex√©s par eux-m√™mes‚Äù."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Conteneurs associatifs :: Cours de C++ - Niveau Master"><meta name=twitter:description content="Un conteneur associatif est un conteneur dans lequel les √©l√©ments peuvent √™tre index√©s par des objets, et non plus seulement par des entiers.
Vous allez donc ici voir les diff√©rents types de conteneurs associatifs propos√©s par la STL.
Pour cet exercice, vous modifierez les fichiers :
- chap-05/3-associatives/main.cpp
- chap-05/3-associatives/keys.h
La cible √† compiler est c5-3-associatives.
Les sets (ensembles) Un set est un conteneur dans lequel les √©l√©ments sont ‚Äúindex√©s par eux-m√™mes‚Äù."><meta property="og:url" content="/chapter5/4-associatives/index.html"><meta property="og:site_name" content="Cours de C++ - Niveau Master"><meta property="og:title" content="Conteneurs associatifs :: Cours de C++ - Niveau Master"><meta property="og:description" content="Un conteneur associatif est un conteneur dans lequel les √©l√©ments peuvent √™tre index√©s par des objets, et non plus seulement par des entiers.
Vous allez donc ici voir les diff√©rents types de conteneurs associatifs propos√©s par la STL.
Pour cet exercice, vous modifierez les fichiers :
- chap-05/3-associatives/main.cpp
- chap-05/3-associatives/keys.h
La cible √† compiler est c5-3-associatives.
Les sets (ensembles) Un set est un conteneur dans lequel les √©l√©ments sont ‚Äúindex√©s par eux-m√™mes‚Äù."><meta property="og:locale" content="fr"><meta property="og:type" content="article"><meta property="article:section" content="Librairie standard"><meta itemprop=name content="Conteneurs associatifs :: Cours de C++ - Niveau Master"><meta itemprop=description content="Un conteneur associatif est un conteneur dans lequel les √©l√©ments peuvent √™tre index√©s par des objets, et non plus seulement par des entiers.
Vous allez donc ici voir les diff√©rents types de conteneurs associatifs propos√©s par la STL.
Pour cet exercice, vous modifierez les fichiers :
- chap-05/3-associatives/main.cpp
- chap-05/3-associatives/keys.h
La cible √† compiler est c5-3-associatives.
Les sets (ensembles) Un set est un conteneur dans lequel les √©l√©ments sont ‚Äúindex√©s par eux-m√™mes‚Äù."><meta itemprop=wordCount content="1983"><title>Conteneurs associatifs :: Cours de C++ - Niveau Master</title>
<link href=../../css/fontawesome-all.min.css?1729268528 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/fontawesome-all.min.css?1729268528 rel=stylesheet></noscript><link href=../../css/nucleus.css?1729268528 rel=stylesheet><link href=../../css/auto-complete.css?1729268528 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/auto-complete.css?1729268528 rel=stylesheet></noscript><link href=../../css/perfect-scrollbar.min.css?1729268528 rel=stylesheet><link href=../../css/fonts.css?1729268528 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/fonts.css?1729268528 rel=stylesheet></noscript><link href=../../css/theme.css?1729268528 rel=stylesheet><link href=../../css/theme-mine.css?1729268528 rel=stylesheet id=R-variant-style><link href=../../css/chroma-relearn-light.css?1729268528 rel=stylesheet id=R-variant-chroma-style><link href=../../css/print.css?1729268528 rel=stylesheet media=print><script src=../../js/variant.js?1729268528></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../..",window.relearn.relBaseUri="../..",window.relearn.absBaseUri="",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.variants&&variants.init(["mine"]),window.T_Copy_to_clipboard=`Copier dans le presse-papiers`,window.T_Copied_to_clipboard=`Copi√© dans le presse-papiers!`,window.T_Copy_link_to_clipboard=`Copier le lien dans le presse-papiers`,window.T_Link_copied_to_clipboard=`Lien copi√© dans le presse-papiers!`,window.T_Reset_view=`R√©initialiser la vue`,window.T_View_reset=`Vue r√©initialis√©e!`,window.T_No_results_found=`Aucun r√©sultat trouv√© pour "{0}"`,window.T_N_results_found=`{1} r√©sultats trouv√©s pour "{0}"`</script></head><body class="mobile-support html disableInlineCopyToClipboard" data-url=../../chapter5/4-associatives/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table des mati√®res (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><ul><li><a href=#les-sets-ensembles>Les sets (ensembles)</a></li><li><a href=#les-maps-dictionnaires>Les maps (dictionnaires)</a></li></ul></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../index.html><span itemprop=name>Accueil</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../chapter5/index.html><span itemprop=name>Librairie standard</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Conteneurs associatifs</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=../../chapter5/3-sequentials/index.html title="Autres conteneurs s√©quentiels (ü°ê)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=../../chapter5/5-strings/index.html title="Manipulation de cha√Ænes (ü°í)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Aller plus loin"><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable chapter5" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=conteneurs-associatifs>Conteneurs associatifs</h1><p>Un conteneur associatif est un conteneur dans lequel les √©l√©ments peuvent √™tre index√©s par des objets, et non plus seulement par des entiers.<br>Vous allez donc ici voir les diff√©rents types de conteneurs associatifs propos√©s par la STL.</p><hr><p>Pour cet exercice, vous modifierez les fichiers :<br>- <code>chap-05/3-associatives/main.cpp</code><br>- <code>chap-05/3-associatives/keys.h</code></p><p>La cible √† compiler est <code>c5-3-associatives</code>.</p><hr><h3 id=les-sets-ensembles>Les sets (ensembles)</h3><p>Un set est un conteneur dans lequel les √©l√©ments sont &ldquo;index√©s par eux-m√™mes&rdquo;. Il y a deux cas d&rsquo;utilisation classiques d&rsquo;un <code>set</code>:</p><ul><li>disposer d&rsquo;un conteneur qui ne peut contenir qu&rsquo;une seule fois un m√™me √©l√©ment,</li><li>savoir si un conteneur contient ou non un √©l√©ment tr√®s rapidement.</li></ul><p>Dans la librairie standard, vous pouvez trouver <code>std::set</code> et <code>std::unordered_set</code> qui permettent de manipuler des sets. En analysant leur documentation, pouvez-vous identifier les diff√©rences principales entre ces deux classes ?</p><div class=expand><input type=checkbox id=R-expand-c1a1b82e3dd4f5c5a1a806595c641124 aria-controls=R-expandcontent-c1a1b82e3dd4f5c5a1a806595c641124>
<label class=expand-label for=R-expand-c1a1b82e3dd4f5c5a1a806595c641124><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-c1a1b82e3dd4f5c5a1a806595c641124 class=expand-content><p>Complexit√© :</p><ul><li><code>std::set</code> est impl√©ment√© (g√©n√©ralement) comme un arbre binaire de recherche. Les op√©rations d&rsquo;insertions, de recherches et de comparaison s&rsquo;effectuent donc en temps logarithmique. En ce qui concerne l&rsquo;espace m√©moire utilis√©, les arbres binaires de recherche ont g√©n√©ralement besoin d&rsquo;autant de m√©moire qu&rsquo;il y a d&rsquo;√©l√©ments √† stocker, c&rsquo;est-√†-dire O(n).</li><li><code>std::unordered_set</code> est impl√©ment√© en utilisant des &ldquo;buckets&rdquo;, index√©s par le hash de l&rsquo;objet (comme dans une hashmap). Les op√©rations d&rsquo;insertions, de recherches et de comparaison s&rsquo;effectuent donc en temps constant amorti (&ldquo;amorti&rdquo;, car si deux objets ont le m√™me hash, il faut potentiellement parcourir une liste d&rsquo;objects ensuite). La documentation ne donne pas de d√©tail concernant l&rsquo;espace m√©moire allou√© par un <code>unordered_set</code>, mais si vous vous rappelez de votre cours d&rsquo;algorithmique, pour qu&rsquo;une hashmap soit efficace, il faut limiter le nombre de conflits possibles. Cela implique que l&rsquo;espace allou√© doit √™tre tr√®s largement sup√©rieur √† l&rsquo;espace r√©ellement occup√© par les √©l√©ments.</li></ul><p>Contraintes :</p><ul><li><code>std::set</code> attend que ses √©l√©ments soient comparables (= qu&rsquo;il existe une fonction permettant de dire si un √©l√©ment est plus petit qu&rsquo;un autre).</li><li><code>std::unordered_set</code> attend que ses √©l√©ments soient hashables (= qu&rsquo;il existe une fonction permettant de convertir un √©l√©ment en un entier, respectant le fait que si deux √©l√©ments sont consid√©r√©s √©gaux, alors les deux entiers obtenus sont √©gaux √©galement) et qu&rsquo;il existe une fonction permettant de savoir si deux √©l√©ments sont √©gaux ou non (il n&rsquo;est pas n√©cessaire ici d&rsquo;avoir une relation d&rsquo;ordre sur les √©l√©ments).</li></ul></div></div><p>Dans les fichiers de l&rsquo;exercice, on vous fournit deux classes <code>ComparableDog</code> et <code>HashableDog</code>. Ces deux classes sont pour le moment identique : elles contiennent deux attributs <code>_name</code> et <code>_species</code>.<br>Votre objectif sera d&rsquo;ajouter les fonctions n√©cessaires pour utiliser ces classes dans des sets.</p><h4 id=stdset><code>std::set</code></h4><p>Pour pouvoir placer des √©l√©ments dans un <code>set</code>, nous avons dit qu&rsquo;ils devaient √™tre comparables. Le plus simple pour cela, c&rsquo;est de cr√©er un <code>operator&lt;</code> pour la classe. Les op√©rateurs de comparaison peuvent √™tre d√©finis soit en tant que fonction-membre, soit en tant que fonction libre.</p><p>Fonction-membre :</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>class</span> <span class=nc>SomeClass</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=kt>bool</span> <span class=k>operator</span><span class=o>&lt;</span><span class=p>(</span><span class=k>const</span> <span class=n>SomeClass</span><span class=o>&amp;</span> <span class=n>other</span><span class=p>)</span> <span class=k>const</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=cm>/* whether this and other are equal */</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span></span></span></code></pre></div><p>Fonction libre :</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=c1>// SomeClass.h
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SomeClass</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>bool</span> <span class=k>operator</span><span class=o>&lt;</span><span class=p>(</span><span class=k>const</span> <span class=n>SomeClass</span><span class=o>&amp;</span> <span class=n>a</span><span class=p>,</span> <span class=k>const</span> <span class=n>SomeClass</span><span class=o>&amp;</span> <span class=n>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// SomeClass.cpp
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>bool</span> <span class=k>operator</span><span class=o>&lt;</span><span class=p>(</span><span class=k>const</span> <span class=n>SomeClass</span><span class=o>&amp;</span> <span class=n>a</span><span class=p>,</span> <span class=k>const</span> <span class=n>SomeClass</span><span class=o>&amp;</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=cm>/* whether a and b are equal */</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Information</div><div class=box-content><p>Notez bien que si vous voulez utiliser une fonction libre, vous devrez peut-√™tre exposer vos attributs dans des getters ou d√©clarer <code>operator&lt;</code> comme une fonction amie de la classe.</p></div></div><p>Commencez par d√©finir un <code>set</code> contenant des <code>ComparableDog</code> dans la fonction <code>main</code>. Essayez de compiler. Jusque l√†, tout devrait bien se passer.<br>Instanciez maintenant une variable de type <code>ComparableDog</code>, et ajoutez-l√† √† votre <code>set</code>.</p><div class=expand><input type=checkbox id=R-expand-8bd52794adfd7fd6af349a70180e8fd5 aria-controls=R-expandcontent-8bd52794adfd7fd6af349a70180e8fd5>
<label class=expand-label for=R-expand-8bd52794adfd7fd6af349a70180e8fd5><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-8bd52794adfd7fd6af349a70180e8fd5 class=expand-content><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>std</span><span class=o>::</span><span class=n>set</span><span class=o>&lt;</span><span class=n>ComparableDog</span><span class=o>&gt;</span> <span class=n>dogs</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ComparableDog</span> <span class=n>medor</span> <span class=p>{</span> <span class=s>&#34;medor&#34;</span><span class=p>,</span> <span class=s>&#34;labrador&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>dogs</span><span class=p>.</span><span class=n>emplace</span><span class=p>(</span><span class=n>medor</span><span class=p>);</span></span></span></code></pre></div></div></div><p>Essayez √† nouveau de compiler. Vos yeux devraient d√©sormais commencer √† saigner, ce qui est normal. Je vous rassure, avec un peu d&rsquo;entra√Ænement, cela n&rsquo;arrivera plus.<br>Du coup, essuyez vos larmes et enfilez vos lunettes si vous en avez, et tentez d&rsquo;identifier ce que le compilateur essaye de vous communiquer.</p><div class=expand><input type=checkbox id=R-expand-b6caea4b6ada870809b86e49bb4c0e0c aria-controls=R-expandcontent-b6caea4b6ada870809b86e49bb4c0e0c>
<label class=expand-label for=R-expand-b6caea4b6ada870809b86e49bb4c0e0c><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-b6caea4b6ada870809b86e49bb4c0e0c class=expand-content><p>Le compilateur essaye simplement de vous dire qu&rsquo;il n&rsquo;arrive pas √† trouver de fonction permettant d&rsquo;√©valuer l&rsquo;expression <code>x &lt; y</code>.<br>Vous allez donc devoir d√©finir un op√©rateur de comparaison pour la classe <code>ComparableDog</code>.</p></div></div><p>Impl√©mentez ce qu&rsquo;il manque pour que votre programme compile.</p><div class=expand><input type=checkbox id=R-expand-f16215e1209fd73c01c2fb69bddd22f8 aria-controls=R-expandcontent-f16215e1209fd73c01c2fb69bddd22f8>
<label class=expand-label for=R-expand-f16215e1209fd73c01c2fb69bddd22f8><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-f16215e1209fd73c01c2fb69bddd22f8 class=expand-content><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>class</span> <span class=nc>ComparableDog</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ComparableDog</span><span class=p>(</span><span class=k>const</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&amp;</span> <span class=n>name</span><span class=p>,</span> <span class=k>const</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&amp;</span> <span class=n>species</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=o>:</span> <span class=n>_name</span> <span class=p>{</span> <span class=n>name</span> <span class=p>},</span> <span class=n>_species</span> <span class=p>{</span> <span class=n>species</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>bool</span> <span class=k>operator</span><span class=o>&lt;</span><span class=p>(</span><span class=k>const</span> <span class=n>ComparableDog</span><span class=o>&amp;</span> <span class=n>other</span><span class=p>)</span> <span class=k>const</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>_name</span> <span class=o>&lt;</span> <span class=n>other</span><span class=p>.</span><span class=n>_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=nf>if</span> <span class=p>(</span><span class=n>_name</span> <span class=o>&gt;</span> <span class=n>other</span><span class=p>.</span><span class=n>_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>_species</span> <span class=o>&lt;</span> <span class=n>other</span><span class=p>.</span><span class=n>_species</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=n>_name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=n>_species</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span></span></span></code></pre></div></div></div><p>Cr√©ez maintenant une nouvelle instance de <code>ComparableDog</code>, diff√©rente de la premi√®re, et ajoutez-l√† au set.<br>Affichez le nombre d&rsquo;√©l√©ments du set pour v√©rifier qu&rsquo;il en contient maintenant 2.</p><div class=expand><input type=checkbox id=R-expand-21ec801d887987838c9cc5f2c6b9a499 aria-controls=R-expandcontent-21ec801d887987838c9cc5f2c6b9a499>
<label class=expand-label for=R-expand-21ec801d887987838c9cc5f2c6b9a499><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-21ec801d887987838c9cc5f2c6b9a499 class=expand-content><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>ComparableDog</span> <span class=n>gus</span> <span class=p>{</span> <span class=s>&#34;gus&#34;</span><span class=p>,</span> <span class=s>&#34;bordercollie&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>dogs</span><span class=p>.</span><span class=n>emplace</span><span class=p>(</span><span class=n>gus</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>std</span><span class=o>::</span><span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>dogs</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span></span></span></code></pre></div></div></div><p>Instanciez maintenant une copie de votre premier chien, et ajoutez-l√† √† votre set.<br>Combien y a-t-il d&rsquo;√©l√©ments dans le <code>set</code> apr√®s cette op√©ration ? Pourquoi ?</p><div class=expand><input type=checkbox id=R-expand-21fed7ea7bf785f83435f3f50b936ded aria-controls=R-expandcontent-21fed7ea7bf785f83435f3f50b936ded>
<label class=expand-label for=R-expand-21fed7ea7bf785f83435f3f50b936ded><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-21fed7ea7bf785f83435f3f50b936ded class=expand-content><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>ComparableDog</span> <span class=n>medor_clone</span> <span class=o>=</span> <span class=n>medor</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>dogs</span><span class=p>.</span><span class=n>emplace</span><span class=p>(</span><span class=n>medor_clone</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>std</span><span class=o>::</span><span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>dogs</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span></span></span></code></pre></div><p>Votre <code>set</code> ne devrait contenir que 2 √©l√©ments, car par d√©finition, dans un set, les √©l√©ments sont uniques. Comme <code>medor</code> existe d√©j√† dans l&rsquo;ensemble, <code>medor_clone</code> qui lui est √©gal n&rsquo;est pas ajout√©.</p><p>Si ce n&rsquo;est pas le cas chez vous et que la copie est ajout√©e malgr√© tout, c&rsquo;est probablement que l&rsquo;impl√©mentation de votre op√©rateur de comparaison est un peu bancale.</p></div></div><h4 id=stdunordered_set><code>std::unordered_set</code></h4><p>Vous allez maintenant faire le m√™me exercice, mais avec un <code>std::unordered_set</code> plut√¥t qu&rsquo;un <code>set</code>.</p><p>Commencez par d√©finir un <code>unordered_set</code> contenant des <code>HashableDog</code> dans la fonction <code>main</code> et essayez de compiler. Vous devriez vous retrouver avec un paquet d&rsquo;erreurs.<br>Comme tout √† l&rsquo;heure, essayez d&rsquo;identifier la cause de leur d√©clenchement.</p><div class=expand><input type=checkbox id=R-expand-6304264cd172b0c71898674475f22c56 aria-controls=R-expandcontent-6304264cd172b0c71898674475f22c56>
<label class=expand-label for=R-expand-6304264cd172b0c71898674475f22c56><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-6304264cd172b0c71898674475f22c56 class=expand-content><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>std</span><span class=o>::</span><span class=n>unordered_set</span><span class=o>&lt;</span><span class=n>HashableDog</span><span class=o>&gt;</span> <span class=n>dogs</span><span class=p>;</span></span></span></code></pre></div><p>Ici, la premi√®re erreur n&rsquo;aide pas du tout : &ldquo;use of deleted function &lsquo;std::unordered_set&lt;$¬£^p%*√π$>&rsquo;&rdquo;.<br>Il faut donc scroller plus bas, jusqu&rsquo;√† tomber sur celle-ci : &ldquo;use of deleted function &lsquo;std::hash<hashabledog>::hash()&rsquo;.</p><p>Rappelez-vous, pour utiliser un <code>unordered_set</code>, une des contraintes est que le type des √©l√©ments doit √™tre hashable. Et d&rsquo;apr√®s l&rsquo;erreur, ce n&rsquo;est pas le cas de <code>HashableDog</code>.</p></div></div><p>Afin de rendre une classe hashable, il faut sp√©cialiser une fonction de la librairie standard que l&rsquo;on appelle <code>hash</code>. Pour ce faire, vous devez d&rsquo;abord inclure le header <code>&lt;functional></code>, puis √©crire le code suivant :</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>namespace</span> <span class=n>std</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>template</span> <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>hash</span><span class=o>&lt;</span><span class=n>ClassToMakeHashable</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>size_t</span> <span class=nf>operator</span><span class=p>()(</span><span class=k>const</span> <span class=n>ClassToMakeHashable</span><span class=o>&amp;</span> <span class=n>c</span><span class=p>)</span> <span class=k>const</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=cm>/* some value that can be computed from c */</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> 
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Ne vous posez pas trop de questions pour le moment sur la syntaxe du code ci-dessus. Vous pouvez directement le copier-coller √† la fin du fichier <code>keys.h</code>, en rempla√ßant <code>ClassToMakeHashable</code> par le nom de votre classe.
En ce qui concerne le contenu de la fonction, vous allez devoir g√©n√©rer un hash en combinant les hashs des attributs de la classe <code>HashableDog</code>.</p><p>Pour r√©cup√©rer le hash d&rsquo;une <code>string</code>, vous devez d√©clarer une variable de type <code>std::hash&lt;std::string></code>, puis appeler son <code>operator()</code> sur la <code>string</code> en question. Ca donne quelque chose comme √ßa :</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>std</span><span class=o>::</span><span class=n>hash</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&gt;</span> <span class=n>hash_fcn</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>size_t</span>                 <span class=n>hash_of_blablabla</span> <span class=o>=</span> <span class=n>hash_fcn</span><span class=p>(</span><span class=s>&#34;blablabla&#34;</span><span class=p>);</span></span></span></code></pre></div><p>Vous pouvez ensuite combiner plusieurs valeurs de hash ensemble en utilisant des op√©rateurs binaires (<code>^</code>, <code>+</code>, <code>*</code>, ou n&rsquo;importe quoi d&rsquo;autres, ce n&rsquo;est pas vraiment important du moment que vous renvoyer bien quelque chose √† la fin) :</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>std</span><span class=o>::</span><span class=n>hash</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&gt;</span> <span class=n>hash_fcn</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>size_t</span>                 <span class=n>hash_final</span> <span class=o>=</span> <span class=n>hash_fcn</span><span class=p>(</span><span class=s>&#34;first&#34;</span><span class=p>)</span> <span class=o>^</span> <span class=n>hash_fcn</span><span class=p>(</span><span class=s>&#34;second&#34;</span><span class=p>)</span> <span class=o>^</span> <span class=n>hash_fcn</span><span class=p>(</span><span class=s>&#34;third&#34;</span><span class=p>);</span></span></span></code></pre></div><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Remarque</div><div class=box-content><p>Lorsqu&rsquo;on d√©fini un <code>operator()</code> dans une classe, il est ensuite possible d&rsquo;utiliser les instances de cette classe comme des fonctions. C&rsquo;est pour cela que ce genre d&rsquo;objets est appel√© <strong>foncteur</strong>.</p></div></div><p>Impl√©mentez le contenu de <code>hash&lt;HashableDog>::operator()</code>.<br>Afin de pouvoir acc√©der aux attributs de <code>HashableDog</code> depuis cette fonction, vous pouvez les d√©placer dans la partie publique.</p><div class=expand><input type=checkbox id=R-expand-bf3b1f1bfcfcaf1ba999a8f5f7e8d1cb aria-controls=R-expandcontent-bf3b1f1bfcfcaf1ba999a8f5f7e8d1cb>
<label class=expand-label for=R-expand-bf3b1f1bfcfcaf1ba999a8f5f7e8d1cb><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-bf3b1f1bfcfcaf1ba999a8f5f7e8d1cb class=expand-content><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>size_t</span> <span class=nf>operator</span><span class=p>()(</span><span class=k>const</span> <span class=n>HashableDog</span><span class=o>&amp;</span> <span class=n>dog</span><span class=p>)</span> <span class=k>const</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>std</span><span class=o>::</span><span class=n>hash</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&gt;</span> <span class=n>hash_fcn</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>hash_fcn</span><span class=p>(</span><span class=n>dog</span><span class=p>.</span><span class=n>_name</span><span class=p>)</span> <span class=o>^</span> <span class=n>hash_fcn</span><span class=p>(</span><span class=n>dog</span><span class=p>.</span><span class=n>_species</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span> 
</span></span></code></pre></div></div></div><p>Une fois que cela compile, refactorisez votre code pour remettre les attributs dans la partie priv√©e.<br>Pour cela, d√©finissez une fonction-membre publique <code>get_hash</code> dans la classe <code>HashableDog</code>, que vous appelerez depuis <code>hash&lt;HashableDog>::operator()</code>.</p><div class=expand><input type=checkbox id=R-expand-f9247a116919259580c1a2864c5ac446 aria-controls=R-expandcontent-f9247a116919259580c1a2864c5ac446>
<label class=expand-label for=R-expand-f9247a116919259580c1a2864c5ac446><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-f9247a116919259580c1a2864c5ac446 class=expand-content><p>N&rsquo;oubliez pas le <code>const</code> dans la signature de <code>get_hash</code>. En effet, vous ne pourrez pas appeler <code>get_hash</code> sur un <code>const HashableDog&</code> si vous oubliez de le mettre.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>class</span> <span class=nc>HashableDog</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>size_t</span> <span class=n>get_hash</span><span class=p>()</span> <span class=k>const</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>std</span><span class=o>::</span><span class=n>hash</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&gt;</span> <span class=n>hash_fcn</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nf>hash_fcn</span><span class=p>(</span><span class=n>_name</span><span class=p>)</span> <span class=o>^</span> <span class=n>hash_fcn</span><span class=p>(</span><span class=n>_species</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=n>std</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>template</span> <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>hash</span><span class=o>&lt;</span><span class=n>HashableDog</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>size_t</span> <span class=nf>operator</span><span class=p>()(</span><span class=k>const</span> <span class=n>HashableDog</span><span class=o>&amp;</span> <span class=n>dog</span><span class=p>)</span> <span class=k>const</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>dog</span><span class=p>.</span><span class=n>get_hash</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><p>Instanciez maintenant une variable de type <code>HashableDog</code>, ajoutez-l√† √† votre set et essayez de compiler.<br>Comme vous pouvez le voir, aujourd&rsquo;hui, le compilateur de vous appr√©cie pas. D√©terminez √† partir des erreurs de compilation ce qu&rsquo;il manque dans la classe <code>HashableDog</code> pour que le programme compile.</p><div class=expand><input type=checkbox id=R-expand-5158e5b855db5ada63943cdac7c28012 aria-controls=R-expandcontent-5158e5b855db5ada63943cdac7c28012>
<label class=expand-label for=R-expand-5158e5b855db5ada63943cdac7c28012><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-5158e5b855db5ada63943cdac7c28012 class=expand-content><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>std</span><span class=o>::</span><span class=n>unordered_set</span><span class=o>&lt;</span><span class=n>HashableDog</span><span class=o>&gt;</span> <span class=n>dogs</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>HashableDog</span> <span class=n>medor</span> <span class=p>{</span> <span class=s>&#34;medor&#34;</span><span class=p>,</span> <span class=s>&#34;labrador&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>dogs</span><span class=p>.</span><span class=n>emplace</span><span class=p>(</span><span class=n>medor</span><span class=p>);</span></span></span></code></pre></div><p>D&rsquo;apr√®s l&rsquo;erreur, il faut impl√©mentez un <code>operator==</code> dans la classe.</p></div></div><p>Ajoutez la fonction manquante (m√™me signature que <code>operator&lt;</code>) et v√©rifiez ensuite que tout fonctionne.</p><div class=expand><input type=checkbox id=R-expand-91450dbf9b8c901124a98610722346e5 aria-controls=R-expandcontent-91450dbf9b8c901124a98610722346e5>
<label class=expand-label for=R-expand-91450dbf9b8c901124a98610722346e5><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-91450dbf9b8c901124a98610722346e5 class=expand-content><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>class</span> <span class=nc>HashableDog</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>bool</span> <span class=k>operator</span><span class=o>==</span><span class=p>(</span><span class=k>const</span> <span class=n>HashableDog</span><span class=o>&amp;</span> <span class=n>other</span><span class=p>)</span> <span class=k>const</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>_name</span> <span class=o>==</span> <span class=n>other</span><span class=p>.</span><span class=n>_name</span> <span class=o>&amp;&amp;</span> <span class=n>_species</span> <span class=o>==</span> <span class=n>other</span><span class=p>.</span><span class=n>_species</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>};</span></span></span></code></pre></div></div></div><p>Vous pouvez ensuite essayer d&rsquo;ajouter de nouveaux √©l√©ments dans votre <code>unordered_set</code>. Vous devriez avoir le m√™me comportement qu&rsquo;avec la classe <code>set</code> : les √©l√©ments sont ajout√©s seulement s&rsquo;ils n&rsquo;apparaissent pas d√©j√† dans le conteneur.</p><hr><h3 id=les-maps-dictionnaires>Les maps (dictionnaires)</h3><p>Une map est un conteneur dans lequel chaque valeur est index√© par une clef. Dans la STL, vous pouvez trouver les classes <code>std::map</code> et <code>std::unordered_map</code>.</p><p>Les diff√©rences entre <code>map</code> et <code>unordered_map</code> sont exactement les m√™mes que les diff√©rences entre <code>set</code> et <code>unordered_set</code>. D&rsquo;ailleurs, <code>std::[unordered_]map</code>, c&rsquo;est la m√™me chose que <code>std::[unordered_]set</code>, si ce n&rsquo;est que pour chaque √©l√©ment du conteneur, on stocke une valeur en plus de la clef.<br>En particulier, vous retrouvez les m√™mes contraintes sur le type des clefs :</p><ul><li>op√©rateur de comparaison pour la clef d&rsquo;une <code>map</code>,</li><li>fonction de hash et op√©rateur d&rsquo;√©galit√© pour la clef d&rsquo;une <code>unordered_map</code>.</li></ul><p>Vous allez maintenant d√©finir une variable de type <code>std::map&lt;key, value></code> qui stocke pour chaque chien (= clef) le nom et pr√©nom de son propri√©taire (= valeur).<br>Quel type pouvez-vous utiliser pour la clef ? Pour la valeur, vous pouvez utiliser une <code>std::pair&lt;std::string, std::string></code> (n&rsquo;h√©sitez pas √† cr√©er un alias).</p><div class=expand><input type=checkbox id=R-expand-60a5878f59cda4c37186cac3be25ae20 aria-controls=R-expandcontent-60a5878f59cda4c37186cac3be25ae20>
<label class=expand-label for=R-expand-60a5878f59cda4c37186cac3be25ae20><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-60a5878f59cda4c37186cac3be25ae20 class=expand-content><p>Pour la clef, on peut r√©utiliser la classe <code>ComparableDog</code>, qui dispose d√©j√† d&rsquo;un op√©rateur de comparaison.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>using</span> <span class=n>Owner</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=p>,</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>std</span><span class=o>::</span><span class=n>map</span><span class=o>&lt;</span><span class=n>ComparableDog</span><span class=p>,</span> <span class=n>Owner</span><span class=o>&gt;</span> <span class=n>owners_by_dog</span><span class=p>;</span></span></span></code></pre></div></div></div><p>Pour ins√©rer des √©l√©ments dans une <code>map</code>, vous pouvez utiliser plein de fonctions diff√©rentes. Consultez la documentation pour trouver le nom de ces fonctions et identifiez leurs diff√©rences (comportement / syntaxe).</p><div class=expand><input type=checkbox id=R-expand-3e8ec84b2dc2268af2a01be40122e4b1 aria-controls=R-expandcontent-3e8ec84b2dc2268af2a01be40122e4b1>
<label class=expand-label for=R-expand-3e8ec84b2dc2268af2a01be40122e4b1><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-3e8ec84b2dc2268af2a01be40122e4b1 class=expand-content><p>Comportement :</p><ul><li><code>insert</code> / <code>emplace</code> / <code>try_emplace</code> : ins√®re l&rsquo;√©l√©ment dans la map seulement si la clef n&rsquo;est pas d√©j√† pr√©sente,</li><li><code>insert_or_assign</code> : ins√®re l&rsquo;√©l√©ment dans la map et remplace l&rsquo;√©l√©ment existant si la clef √©tait d√©j√† pr√©sente,</li></ul><p>Syntaxe :</p><ul><li><code>insert</code> : la fonction attend une <code>pair</code> : <code>dict.insert(std::make_pair(key, value));</code> / <code>dict.insert({ key, value });</code></li><li><code>insert_or_assign</code> : on peut passer la clef et la valeur directement : <code>dict.insert_or_assign(key, value);</code></li><li><code>emplace</code> : on peut aussi passer la clef et la valeur directement : <code>dict.emplace(key, value);</code></li><li><code>try_emplace</code> : on peut passer la clef en premier, puis les param√®tres de construction de la valeur √† la suite : <code>dict.try_emplace(key, p1, p2, p3);</code></li></ul></div></div><p>Essayez d&rsquo;ajouter plusieurs √©l√©ments √† votre map, en utilisant chacune de ces fonctions.<br><div class=expand><input type=checkbox id=R-expand-17679be4fe8c178919e593dce45f365a aria-controls=R-expandcontent-17679be4fe8c178919e593dce45f365a>
<label class=expand-label for=R-expand-17679be4fe8c178919e593dce45f365a><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-17679be4fe8c178919e593dce45f365a class=expand-content><p>Pour la clef, on peut r√©utiliser la classe <code>ComparableDog</code>, qui dispose d√©j√† d&rsquo;un op√©rateur de comparaison.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>std</span><span class=o>::</span><span class=n>map</span><span class=o>&lt;</span><span class=n>ComparableDog</span><span class=p>,</span> <span class=n>Owner</span><span class=o>&gt;</span> <span class=n>owners_by_dog</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ComparableDog</span> <span class=n>medor</span> <span class=p>{</span> <span class=s>&#34;medor&#34;</span><span class=p>,</span> <span class=s>&#34;labrador&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>ComparableDog</span> <span class=n>gus</span> <span class=p>{</span> <span class=s>&#34;gus&#34;</span><span class=p>,</span> <span class=s>&#34;bordercollie&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>ComparableDog</span> <span class=n>zim</span> <span class=p>{</span> <span class=s>&#34;zim&#34;</span><span class=p>,</span> <span class=s>&#34;poodle&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>ComparableDog</span> <span class=n>flippy</span> <span class=p>{</span> <span class=s>&#34;flippy&#34;</span><span class=p>,</span> <span class=s>&#34;spaniel&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>owners_by_dog</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>make_pair</span><span class=p>(</span><span class=n>medor</span><span class=p>,</span> <span class=n>Owner</span> <span class=p>{</span> <span class=s>&#34;Claire&#34;</span><span class=p>,</span> <span class=s>&#34;David&#34;</span> <span class=p>}));</span>
</span></span><span class=line><span class=cl><span class=n>owners_by_dog</span><span class=p>.</span><span class=n>insert_or_assign</span><span class=p>(</span><span class=n>gus</span><span class=p>,</span> <span class=n>Owner</span> <span class=p>{</span> <span class=s>&#34;Marc&#34;</span><span class=p>,</span> <span class=s>&#34;Zipstein&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=n>owners_by_dog</span><span class=p>.</span><span class=n>emplace</span><span class=p>(</span><span class=n>zim</span><span class=p>,</span> <span class=n>Owner</span> <span class=p>{</span> <span class=s>&#34;C√©line&#34;</span><span class=p>,</span> <span class=s>&#34;No√´l&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=n>owners_by_dog</span><span class=p>.</span><span class=n>try_emplace</span><span class=p>(</span><span class=n>flippy</span><span class=p>,</span> <span class=s>&#34;Vincent&#34;</span><span class=p>,</span> <span class=s>&#34;Nozick&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>owners_by_dog</span><span class=p>.</span><span class=n>emplace</span><span class=p>(</span><span class=n>gus</span><span class=p>,</span> <span class=n>Owner</span> <span class=p>{</span> <span class=s>&#34;Claire&#34;</span><span class=p>,</span> <span class=s>&#34;David&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=c1>// -&gt; gus is still owned by Marc (emplace does not modify values with existing keys, neither does insert or try_emplace)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=n>owners_by_dog</span><span class=p>.</span><span class=n>insert_or_assign</span><span class=p>(</span><span class=n>gus</span><span class=p>,</span> <span class=n>Owner</span> <span class=p>{</span> <span class=s>&#34;Vincent&#34;</span><span class=p>,</span> <span class=s>&#34;Nozick&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=c1>// -&gt; gus is now owned by Vincent (insert_or_assign reassign values with existing keys)
</span></span></span></code></pre></div></div></div></p><p>Que faut-il maintenant faire si vous souhaitez utiliser une <code>unordered_map</code> plut√¥t qu&rsquo;une <code>map</code> ?</p><div class=expand><input type=checkbox id=R-expand-9f755b4b157d434b98331ff115dce3e9 aria-controls=R-expandcontent-9f755b4b157d434b98331ff115dce3e9>
<label class=expand-label for=R-expand-9f755b4b157d434b98331ff115dce3e9><i class="expander-icon fa-fw fas fa-chevron-down"></i>
<i class="expander-icon fa-fw fas fa-chevron-right"></i> Solution</label><div id=R-expandcontent-9f755b4b157d434b98331ff115dce3e9 class=expand-content><p>Il suffit d&rsquo;utiliser des clefs de type <code>HashableDog</code> plut√¥t que <code>ComparableDog</code>.</p></div></div><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class="default-animation showVisitedLinks"><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=logo href=../../>üéÑ C++ üéÑ</a></div></div><div id=R-homelinks class=default-animation><hr class=padding></div><div id=R-content-wrapper class=highlightable><div id=R-topics><ul class="enlarge morespace collapsible-menu"><li data-nav-id=/chapter0/index.html><a class=padding href=../../chapter0/index.html><b>0- </b>Mise en place<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-bb41caf94f12b8a1a4b5e560230e7851 class=collapsible-menu></ul></li><li data-nav-id=/chapter1/index.html><a class=padding href=../../chapter1/index.html><b>1- </b>Introduction au C++<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-6c398714eae4372920aec3a1e6c2e143 class=collapsible-menu></ul></li><li data-nav-id=/chapter2/index.html><a class=padding href=../../chapter2/index.html><b>2- </b>Classes<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-b1df0095a9fd74320697a6d478418ec3 class=collapsible-menu></ul></li><li data-nav-id=/chapter3/index.html><a class=padding href=../../chapter3/index.html><b>3- </b>Cycle de vie<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-9f6546bce6f8e9a77063b71c880fd5b8 class=collapsible-menu></ul></li><li data-nav-id=/chapter4/index.html><a class=padding href=../../chapter4/index.html><b>4- </b>H√©ritage<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-48065e8b6e7e69533ca73b3931c8a0a1 class=collapsible-menu></ul></li><li class=parent data-nav-id=/chapter5/index.html><a class=padding href=../../chapter5/index.html><b>5- </b>Librairie standard<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-86528e6ba587b53932a1dafaa9cd375c class=collapsible-menu><li data-nav-id=/chapter5/1-doc/index.html><a class=padding href=../../chapter5/1-doc/index.html>Un peu de doc...<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-id=/chapter5/2-vectors/index.html><a class=padding href=../../chapter5/2-vectors/index.html>Tableaux dynamiques<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-id=/chapter5/3-sequentials/index.html><a class=padding href=../../chapter5/3-sequentials/index.html>Autres conteneurs s√©quentiels<i class="fa-fw fas fa-check read-icon"></i></a></li><li class=active data-nav-id=/chapter5/4-associatives/index.html><a class=padding href=../../chapter5/4-associatives/index.html>Conteneurs associatifs<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-id=/chapter5/5-strings/index.html><a class=padding href=../../chapter5/5-strings/index.html>Manipulation de cha√Ænes<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-id=/chapter5/6-tuples/index.html><a class=padding href=../../chapter5/6-tuples/index.html>Paires et tuples<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-id=/chapter5/test/index.html><a class=padding href=../../chapter5/test/index.html>Questionnaire ‚òë<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-id=/chapter5/summary/index.html><a class=padding href=../../chapter5/summary/index.html>Synth√®se<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/chapter6/index.html><a class=padding href=../../chapter6/index.html><b>6- </b>Algorithmes<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-016ee40825ff7c4aeecbac08a8ca264b class=collapsible-menu></ul></li><li data-nav-id=/chapter9/index.html><a class=padding href=../../chapter9/index.html><b>7- </b>Templates<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-24ddf636ccd0ce3ef39c8060d1779332 class=collapsible-menu></ul></li><li data-nav-id=/chapter10/index.html><a class=padding href=../../chapter10/index.html><b>8- </b>Param√®tres de templates<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-66e6e0c58d73995ecc09e8fbbe358e51 class=collapsible-menu></ul></li></ul></div><div id=R-shortcuts><div class="nav-title padding">Acc√®s rapide</div><ul class=space><li><a class=padding href=https://github.com/Laefy/CPP_Learning_Code/><i class='fab fa-github'></i> D√©p√¥t Cours</a></li><li><a class=padding href=https://github.com/Laefy/CPP_Exercises/><i class='fab fa-github'></i> D√©p√¥t TPs</a></li><li><a class=padding href=../../slides/index.html><i class='far fa-file-powerpoint'></i> Slides</a></li><li><a class=padding href=../../workflow/index.html><i class='far fa-list-alt'></i> Workflow</a></li><li><a class=padding href=../../faq/index.html><i class='fas fa-question-circle'></i> FAQ</a></li><li><a class=padding href=../../chapter0/6-tips/index.html><i class='fa fa-rocket'></i> Astuces</a></li><li><a class=padding href=https://godbolt.org/><i class='fas fa-cog'></i> Compiler Explorer</a></li><li><a class=padding href=https://en.cppreference.com/w/><i class='fas fa-passport'></i> CPP-Ref</a></li></ul></div><div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"></div><div id=R-menu-footer><hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"><div id=R-prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVisitedLinks"><ul><li id=R-select-language-container class=footerLangSwitch><div class="padding menu-control"><i class="fa-fw fas fa-language"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=R-select-language>Langue</label>
<select id=R-select-language onchange="location=this.querySelector(this.value).dataset.url"><option id=R-select-language-fr value=#R-select-language-fr data-url=../../chapter5/4-associatives/index.html lang=fr selected>Fran√ßais</option></select></div><div class=clear></div></div></li><li id=R-select-variant-container class=footerVariantSwitch><div class="padding menu-control"><i class="fa-fw fas fa-paint-brush"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=R-select-variant>Th√®me</label>
<select id=R-select-variant onchange=window.variants&&variants.changeVariant(this.value)><option id=R-select-variant-mine value=mine selected>Mine</option></select></div><div class=clear></div></div><script>window.variants&&variants.markSelectedVariant()</script></li><li class="footerVisitedLinks showVisitedLinks"><div class="padding menu-control"><i class="fa-fw fas fa-history"></i>
<span>&nbsp;</span><div class=control-style><button onclick=clearHistory()>Supprimer l'historique</button></div><div class=clear></div></div></li></ul></div><div id=R-footer class="footerFooter showFooter"><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></div></aside><script src=../../js/clipboard.min.js?1729268528 defer></script><script src=../../js/perfect-scrollbar.min.js?1729268528 defer></script><script src=../../js/theme.js?1729268528 defer></script><button id=footer-question-btn title="Envoyer un message √† propos du texte s√©lectionn√©" onclick=openQuestionForm() disabled><i class="fas fa-question-circle"></i></button><div id=footer-question-window disabled><form id=question method=POST action=https://formsubmit.co/3aa0f379a1aed9c454634cc2da153a7b target=question-submitted onsubmit=cleanQuestionFormContent()><input type=email name=email placeholder=mon_email@smthg.com required onchange=updateQuestionFormSubject()>
<textarea name=question rows=7 cols=30 placeholder="Mon message..."></textarea>
<input type=hidden name=selection>
<input type=hidden name=_replyto>
<input type=hidden name=_subject>
<input type=hidden name=_template value=box>
<input type=hidden name=_captcha value=false>
<input type=hidden name=_next value=//question-submitted/>
<input type=submit disabled style=display:none aria-hidden=true>
<input type=submit value=Envoyer></form><iframe class=hidden name=question-submitted src></iframe></div><script>function updateQuestionFormSubject(){let e=document.querySelector('#question>input[name="email"]').value;document.querySelector('#question>input[name="_subject"]').value="[C++][Chapitre 5] "+e+", retour sur ta question"}function cleanQuestionFormContent(){function e(e){e.value=e.value.replace(/\[\.\./g,"[ ..")}e(document.querySelector('#question>textarea[name="question"]')),e(document.querySelector('#question>input[name="selection"]'))}function openQuestionForm(){document.getElementById("footer-question-window").removeAttribute("disabled");var e=window.getSelection().toString();document.querySelector('#question>input[name="selection"]').value=e}function updateQuestionWidgetState(e){var t=document.getElementById("R-body-inner"),n=window.getSelection(),s=document.getElementById("footer-question-window");document.getElementById("footer-question-btn").disabled=n.isCollapsed||t==null||t.contains(n.anchorNode)==!1||t.contains(n.focusNode)==!1,e!==void 0&&e.type=="mouseup"&&s.contains(e.target)==!1&&s.contains(document.activeElement)==!1&&s.setAttribute("disabled",!0)}updateQuestionFormSubject(),document.onmouseup=document.onkeyup=document.onselectionchange=updateQuestionWidgetState,updateQuestionWidgetState()</script></body></html>