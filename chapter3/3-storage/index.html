<!doctype html><html lang=fr dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 7.0.1+72a875f1db967152c77914cff4d53f8fcee0e619"><meta name=description content="Sur cette page, nous rappelerons ce que sont les variables et les pointeurs, et comment ils peuvent √™tre repr√©sent√©s en m√©moire, puis nous ferons de m√™me pour les r√©f√©rences.
Nous pr√©senterons ensuite les sp√©cificit√©s des trois zones dans lesquelles le programme alloue de la m√©moire : la m√©moire statique, la pile et le tas.
Cela vous aidera, j‚Äôesp√®re, √† visualiser mentalement quelles sont les donn√©es valides du programme.
Repr√©sentation Variables Une variable est un identifiant permettant d‚Äôacc√©der √† une donn√©e de taille fixe en m√©moire."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Espace de stockage üíæ :: Cours de C++ - Niveau Master"><meta name=twitter:description content="Sur cette page, nous rappelerons ce que sont les variables et les pointeurs, et comment ils peuvent √™tre repr√©sent√©s en m√©moire, puis nous ferons de m√™me pour les r√©f√©rences.
Nous pr√©senterons ensuite les sp√©cificit√©s des trois zones dans lesquelles le programme alloue de la m√©moire : la m√©moire statique, la pile et le tas.
Cela vous aidera, j‚Äôesp√®re, √† visualiser mentalement quelles sont les donn√©es valides du programme.
Repr√©sentation Variables Une variable est un identifiant permettant d‚Äôacc√©der √† une donn√©e de taille fixe en m√©moire."><meta property="og:url" content="/chapter3/3-storage/index.html"><meta property="og:site_name" content="Cours de C++ - Niveau Master"><meta property="og:title" content="Espace de stockage üíæ :: Cours de C++ - Niveau Master"><meta property="og:description" content="Sur cette page, nous rappelerons ce que sont les variables et les pointeurs, et comment ils peuvent √™tre repr√©sent√©s en m√©moire, puis nous ferons de m√™me pour les r√©f√©rences.
Nous pr√©senterons ensuite les sp√©cificit√©s des trois zones dans lesquelles le programme alloue de la m√©moire : la m√©moire statique, la pile et le tas.
Cela vous aidera, j‚Äôesp√®re, √† visualiser mentalement quelles sont les donn√©es valides du programme.
Repr√©sentation Variables Une variable est un identifiant permettant d‚Äôacc√©der √† une donn√©e de taille fixe en m√©moire."><meta property="og:locale" content="fr"><meta property="og:type" content="article"><meta property="article:section" content="Cycle de vie"><meta itemprop=name content="Espace de stockage üíæ :: Cours de C++ - Niveau Master"><meta itemprop=description content="Sur cette page, nous rappelerons ce que sont les variables et les pointeurs, et comment ils peuvent √™tre repr√©sent√©s en m√©moire, puis nous ferons de m√™me pour les r√©f√©rences.
Nous pr√©senterons ensuite les sp√©cificit√©s des trois zones dans lesquelles le programme alloue de la m√©moire : la m√©moire statique, la pile et le tas.
Cela vous aidera, j‚Äôesp√®re, √† visualiser mentalement quelles sont les donn√©es valides du programme.
Repr√©sentation Variables Une variable est un identifiant permettant d‚Äôacc√©der √† une donn√©e de taille fixe en m√©moire."><meta itemprop=wordCount content="1249"><title>Espace de stockage üíæ :: Cours de C++ - Niveau Master</title>
<link href=../../css/fontawesome-all.min.css?1729268597 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/fontawesome-all.min.css?1729268597 rel=stylesheet></noscript><link href=../../css/nucleus.css?1729268597 rel=stylesheet><link href=../../css/auto-complete.css?1729268597 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/auto-complete.css?1729268597 rel=stylesheet></noscript><link href=../../css/perfect-scrollbar.min.css?1729268597 rel=stylesheet><link href=../../css/fonts.css?1729268597 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/fonts.css?1729268597 rel=stylesheet></noscript><link href=../../css/theme.css?1729268597 rel=stylesheet><link href=../../css/theme-mine.css?1729268597 rel=stylesheet id=R-variant-style><link href=../../css/chroma-relearn-light.css?1729268597 rel=stylesheet id=R-variant-chroma-style><link href=../../css/print.css?1729268597 rel=stylesheet media=print><script src=../../js/variant.js?1729268597></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../..",window.relearn.relBaseUri="../..",window.relearn.absBaseUri="",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.variants&&variants.init(["mine"]),window.T_Copy_to_clipboard=`Copier dans le presse-papiers`,window.T_Copied_to_clipboard=`Copi√© dans le presse-papiers!`,window.T_Copy_link_to_clipboard=`Copier le lien dans le presse-papiers`,window.T_Link_copied_to_clipboard=`Lien copi√© dans le presse-papiers!`,window.T_Reset_view=`R√©initialiser la vue`,window.T_View_reset=`Vue r√©initialis√©e!`,window.T_No_results_found=`Aucun r√©sultat trouv√© pour "{0}"`,window.T_N_results_found=`{1} r√©sultats trouv√©s pour "{0}"`</script></head><body class="mobile-support html disableInlineCopyToClipboard" data-url=../../chapter3/3-storage/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table des mati√®res (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><ul><li><a href=#repr√©sentation>Repr√©sentation</a></li><li><a href=#la-m√©moire-statique>La m√©moire statique</a></li><li><a href=#la-pile>La pile</a></li><li><a href=#le-tas>Le tas</a></li><li><a href=#synth√®se>Synth√®se</a></li></ul></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../index.html><span itemprop=name>Accueil</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../chapter3/index.html><span itemprop=name>Cycle de vie</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Espace de stockage üíæ</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=../../chapter3/2-lifespan/index.html title="Dur√©e de vie ‚è≥ (ü°ê)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=../../chapter3/4-references/index.html title="Usage des r√©f√©rences üîÄ (ü°í)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Aller plus loin"><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable chapter3" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=espace-de-stockage->Espace de stockage üíæ</h1><p>Sur cette page, nous rappelerons ce que sont les variables et les pointeurs, et comment ils peuvent √™tre repr√©sent√©s en m√©moire, puis nous ferons de m√™me pour les r√©f√©rences.<br>Nous pr√©senterons ensuite les sp√©cificit√©s des trois zones dans lesquelles le programme alloue de la m√©moire : la <strong>m√©moire statique</strong>, la <strong>pile</strong> et le <strong>tas</strong>.<br>Cela vous aidera, j&rsquo;esp√®re, √† visualiser mentalement quelles sont les donn√©es valides du programme.</p><hr><h3 id=repr√©sentation>Repr√©sentation</h3><h4 id=variables>Variables</h4><p>Une variable est un identifiant permettant d&rsquo;acc√©der √† une donn√©e de taille fixe en m√©moire.<br>L&rsquo;emplacement pr√©cis de cette donn√©e constitue l&rsquo;adresse de la variable.
Sur un ordinateur moderne, il s&rsquo;agira g√©n√©ralement d&rsquo;un entier encod√© sur 64 bits.</p><p>Si on repr√©sente la m√©moire comme un tableau dans lequel chaque case est un octet, alors nous pouvons repr√©senter une variable comme une s√©rie contigu√´ de cases de ce tableau.</p><p>Supposons que le code suivant alloue <code>var</code> √† l&rsquo;adresse <code>0x00e8</code> (attention pour la suite, on compte en hexad√©cimal !).</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=n>var</span> <span class=o>=</span> <span class=mi>145</span><span class=p>;</span></span></span></code></pre></div><p>Comme <code>var</code> est de type entier, la zone m√©moire s&rsquo;√©tend sur 4 octets, c&rsquo;est-√†-dire entre <code>0x00e8</code> et <code>0x00eb</code>.</p><p><a href=#R-image-2ceff9aea917f09bf37e842ed2b10422 class=lightbox-link><img alt="Repr√©sentation d&rsquo;une variable en m√©moire" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/chapter3/storage/01-var.svg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2ceff9aea917f09bf37e842ed2b10422><img alt="Repr√©sentation d&rsquo;une variable en m√©moire" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/chapter3/storage/01-var.svg></a></p><h4 id=pointeurs>Pointeurs</h4><p>Un pointeur est une variable dont le r√¥le est de stocker l&rsquo;adresse d&rsquo;une autre variable.<br>Si les adresses sont encod√©es sur 64 bits, la taille d&rsquo;un pointeur est de 8 octets.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span><span class=o>*</span> <span class=n>ptr</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>var</span><span class=p>;</span></span></span></code></pre></div><p><a href=#R-image-0a04e02f2f3610267e3f2cf938d8352a class=lightbox-link><img alt="Repr√©sentation d&rsquo;un pointeur en m√©moire" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/chapter3/storage/02-ptr.svg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0a04e02f2f3610267e3f2cf938d8352a><img alt="Repr√©sentation d&rsquo;un pointeur en m√©moire" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/chapter3/storage/02-ptr.svg></a></p><h4 id=r√©f√©rences>R√©f√©rences</h4><p>Une r√©f√©rence est un alias de variable.
Elle identifie le m√™me emplacement que la variable d&rsquo;origine.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span><span class=o>&amp;</span> <span class=n>ref</span> <span class=o>=</span> <span class=n>var</span><span class=p>;</span></span></span></code></pre></div><p>Ci-dessous, <code>ref</code> correspond donc au m√™me bloc que <code>var</code>.<br>Nous l&rsquo;avons repr√©sent√© en italique pour indiquer que la dur√©e de vie de la donn√©e n&rsquo;est pas coupl√©e √† l&rsquo;identifiant <code>ref</code>.</p><p><a href=#R-image-7c67afebe7824cce3fd1a4a3a2eee4fa class=lightbox-link><img alt="Repr√©sentation d&rsquo;une r√©f√©rence en m√©moire" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/chapter3/storage/03-ref.svg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7c67afebe7824cce3fd1a4a3a2eee4fa><img alt="Repr√©sentation d&rsquo;une r√©f√©rence en m√©moire" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/chapter3/storage/03-ref.svg></a></p><h4 id=type-structur√©>Type-structur√©</h4><p>Dans le cas des types-structur√©s, les attributs d&rsquo;un objet sont allou√©s au sein de l&rsquo;espace allou√© pour l&rsquo;objet lui-m√™me.</p><p>La taille d&rsquo;un objet est donc souvent √©gale √† la somme des tailles de ses attributs, mais ce n&rsquo;est pas toujours le cas&mldr;<br>En effet, le processeur est plus efficace pour acc√©der √† certaines donn√©es si celles-ci sont √©crites √† des adresses multiples d&rsquo;un certain nombre.
Par exemple, il lira plus vite un <code>int</code> si celui-ci est √©crit √† une adresse multiple de <code>4</code>.<br>Le compilateur pourra donc d√©cider de laisser du vide entre un attribut de type <code>char</code> (1 octet) et un attribut de type <code>int</code> (4 octets) afin d&rsquo;<strong>aligner</strong> l&rsquo;entier sur la bonne adresse.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>struct</span> <span class=nc>Box</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>v1</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=n>c</span> <span class=o>=</span> <span class=sc>&#39;A&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>v2</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Box</span> <span class=n>box</span><span class=p>;</span></span></span></code></pre></div><p><a href=#R-image-01e5624db85662bd78dd1000c4275e8c class=lightbox-link><img alt="Repr√©sentation d&rsquo;un objet en m√©moire" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/chapter3/storage/04-struct.svg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-01e5624db85662bd78dd1000c4275e8c><img alt="Repr√©sentation d&rsquo;un objet en m√©moire" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/chapter3/storage/04-struct.svg></a></p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Astuce</div><div class=box-content><p>Si vous voulez √©viter de perdre de l&rsquo;espace dans vos types-structur√©s, vous pouvez modifier l&rsquo;ordre dans lequel vous d√©finissez vos attributs.<br>Attention cependant, notez bien que cela modifie aussi l&rsquo;ordre dans lequel ils sont instanci√©s !</p></div></div><hr><h3 id=la-m√©moire-statique>La m√©moire statique</h3><p>La <strong>m√©moire statique</strong> est la zone contenant les donn√©es associ√©es aux variables globales du programme.</p><p>Comme la taille d&rsquo;une variable d√©pend uniquement de son type, la compilation permet de d√©terminer la quantit√© d&rsquo;espace √† allouer pour le segment de m√©moire statique.
Il est r√©serv√© une fois pour toute par le syst√®me d&rsquo;exploitation au lancement du programme, et est restitu√© une fois la fonction <code>main</code> termin√©e.</p><p>Il n&rsquo;est pas possible d&rsquo;augmenter ou de r√©duire l&rsquo;espace r√©serv√© au cours de l&rsquo;ex√©cution du programme, et c&rsquo;est pour cela qu&rsquo;on parle de m√©moire &ldquo;statique&rdquo;.</p><hr><h3 id=la-pile>La pile</h3><p>La <strong>pile</strong> est l&rsquo;espace m√©moire dans lequel sont stock√©es la plupart des variables locales.<br>Il s&rsquo;agit d&rsquo;un espace de taille limit√©e (quelques m√©ga-octets en g√©n√©ral, cela d√©pend du syst√®me), mais dans lequel il est tr√®s rapide d&rsquo;acc√©der et de modifier les donn√©es.<br>De plus, l&rsquo;allocation est <strong>imm√©diate</strong>, car cet espace est r√©serv√© √† votre programme d√®s qu&rsquo;il d√©marre.</p><div class="highlight wrap-code" linenos=table><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=nf>f2</span><span class=p>(</span><span class=kt>int</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>auto</span> <span class=n>b</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=n>p</span> <span class=o>+</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>f1</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>auto</span> <span class=n>v1</span> <span class=o>=</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>auto</span> <span class=n>v2</span> <span class=o>=</span> <span class=n>f2</span><span class=p>(</span><span class=n>v1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>auto</span> <span class=n>v3</span> <span class=o>=</span> <span class=sc>&#39;a&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>A l&rsquo;ex√©cution, la pile pourrait avoir le contenu suivant :
<a href=#R-image-a59e29d0acc079c95db68c6ac271c7a5 class=lightbox-link><img alt="Contenu de la pile" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/chapter3/storage/05-stack.svg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a59e29d0acc079c95db68c6ac271c7a5><img alt="Contenu de la pile" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/chapter3/storage/05-stack.svg></a></p><p>Le haut de la pile est indiqu√© par la fl√®che.<br><code>l.9</code>: On entre d&rsquo;abord dans la fonction <code>f1</code>.<br><code>l.10</code>: On ajoute la variable <code>v1</code> dans la pile et on l&rsquo;initialise √† <code>5</code>.<br><code>l.2</code>: Ensuite, on appelle la fonction <code>f2</code>. On empile le param√®tre <code>p</code> contenant la valeur <code>5</code>.<br><code>l.3</code>: On ajoute <code>b</code> √† la pile, puis on ex√©cute le restant de la fonction.<br><code>l.6</code>: Une fois <code>f2</code> termin√©e, toutes les variables d√©finies dedans sont retir√©es de la pile.<br><code>l.11</code>: On place ensuite <code>v2</code> dans la pile, initialis√©e √† la valeur de retour de <code>f2</code>.<br><code>l.12</code>: Enfin, on empile <code>v3</code> et on ex√©cute le restant de la fonction.<br><code>l.12</code>: √Ä la fin de l&rsquo;appel √† <code>f1</code>, on retire toutes les variables locales de la pile.</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Remarque</div><div class=box-content><p>Notez bien que ce sc√©nario n&rsquo;est qu&rsquo;une hypoth√®se de ce qu&rsquo;il pourrait se passer en r√©alit√©.
En fonction de l&rsquo;impl√©mentation de votre compilateur et des instructions qu&rsquo;il produit, le contenu de la pile ne sera pas le m√™me.
Par exemple, √† des fins d&rsquo;optimisation, il est fort probable que certaines variables soient stock√©es directement dans les registres du processeur plut√¥t que sur la pile.</p></div></div><hr><h3 id=le-tas>Le tas</h3><p>Les donn√©es sont allou√©es sur le <strong>tas</strong> d√®s lors qu&rsquo;elles sont allou√©es dynamiquement (c&rsquo;est-√†-dire via un <code>new</code>).</p><p>Contrairement √† l&rsquo;allocation sur la pile, l&rsquo;allocation sur le tas est co√ªteuse en temps.<br>En effet, le processus doit demander au syst√®me d&rsquo;exploitation qu&rsquo;il lui alloue un segment de m√©moire-vive de taille suffisante pour stocker l&rsquo;objet.<br>Cette op√©ration est longue car, comme tous les appels-syst√®me, elle n√©cessite de rendre la main au syst√®me d&rsquo;exploitation et donc de changer de contexte d&rsquo;ex√©cution.</p><p>L&rsquo;acc√®s est √©galement plus lent que sur la pile, car les donn√©es ne sont pas forc√©ment regroup√©es : elles sont stock√©es l√† o√π le syst√®me a trouv√© assez d&rsquo;espace pour l&rsquo;allocation.
On a donc plus souvent des <em>cache-miss</em> (litteralement &ldquo;√©chec de cache&rdquo;, c&rsquo;est-√†-dire lorsque le cache ne contient pas le contenu demand√©) que lorsqu&rsquo;on acc√®de aux donn√©es de la pile.</p><p>Il y a tout de m√™me des avantages √† allouer sur le tas.<br>D√©j√†, on peut allouer autant de donn√©es qu&rsquo;on le souhaite (ou tout du moins, autant que votre machine vous le permette).<br>Ensuite, les donn√©es restent disponibles tant qu&rsquo;on ne d√©cide pas de les d√©sinstancier.
Cela permet d&rsquo;instancier des objets dans une fonction et qu&rsquo;ils ne soient pas d√©sinstanci√©s au retour vers l&rsquo;appelant.</p><div class="highlight wrap-code" linenos=table><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span><span class=o>*</span> <span class=nf>make_int</span><span class=p>(</span><span class=kt>int</span> <span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span><span class=o>*</span> <span class=n>ptr</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span> <span class=p>{</span> <span class=n>value</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ptr</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>auto</span><span class=o>*</span> <span class=n>ptr_1</span> <span class=o>=</span> <span class=n>make_int</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>std</span><span class=o>::</span><span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=o>*</span><span class=n>ptr_1</span> <span class=o>&lt;&lt;</span> <span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>delete</span> <span class=n>ptr_1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p><a href=#R-image-463c49caa2d646a00ff4a5138157cf0b class=lightbox-link><img alt="Contenu de la pile et du tas" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/chapter3/storage/06-heap.svg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-463c49caa2d646a00ff4a5138157cf0b><img alt="Contenu de la pile et du tas" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/chapter3/storage/06-heap.svg></a></p><p><code>l.9</code>: On appelle la fonction <code>make_int</code> avec l&rsquo;argument <code>1</code>.<br><code>l.2</code>: On entre dans la fonction, on ajoute le param√®tre <code>value</code> dans la pile.<br><code>l.3</code>: On alloue un entier de valeur <code>1</code> sur le tas, et on stocke l&rsquo;adresse dans <code>ptr</code>.<br><code>l.5</code>: On sort de la fonction, donc on d√©pile les variables locales mais le contenu du tas ne change pas.<br><code>l.9</code>: On stocke la valeur de retour de <code>make_int</code> dans <code>ptr_1</code>.<br><code>l.11</code>: On demande la d√©sinstanciation de l&rsquo;entier allou√© sur le tas.<br><code>l.14</code>: On sort du <code>main</code>, donc on d√©pile toutes les variables d√©finies dedans.</p><hr><h3 id=synth√®se>Synth√®se</h3><ul><li>Les variables globales et statiques sont allou√©es dans la <strong>m√©moire statique</strong> du programme.</li><li>Les variables locales sont allou√©es sur la <strong>pile</strong> ou dans les registres du processeur.<br>Sa taille est limit√©e, mais l&rsquo;allocation des donn√©es est imm√©diate et les acc√®s tr√®s rapides.</li><li>Les donn√©es allou√©es dynamiquement sont plac√©es dans le <strong>tas</strong>.<br>L&rsquo;allocation et les acc√®s peuvent √™tre longs, mais la quantit√© d&rsquo;espace disponible est tr√®s importante.</li></ul><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class="default-animation showVisitedLinks"><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=logo href=../../>üéÑ C++ üéÑ</a></div></div><div id=R-homelinks class=default-animation><hr class=padding></div><div id=R-content-wrapper class=highlightable><div id=R-topics><ul class="enlarge morespace collapsible-menu"><li data-nav-id=/chapter0/index.html><a class=padding href=../../chapter0/index.html><b>0- </b>Mise en place<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-bb41caf94f12b8a1a4b5e560230e7851 class=collapsible-menu></ul></li><li data-nav-id=/chapter1/index.html><a class=padding href=../../chapter1/index.html><b>1- </b>Introduction au C++<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-6c398714eae4372920aec3a1e6c2e143 class=collapsible-menu></ul></li><li data-nav-id=/chapter2/index.html><a class=padding href=../../chapter2/index.html><b>2- </b>Classes<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-b1df0095a9fd74320697a6d478418ec3 class=collapsible-menu></ul></li><li class=parent data-nav-id=/chapter3/index.html><a class=padding href=../../chapter3/index.html><b>3- </b>Cycle de vie<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-9f6546bce6f8e9a77063b71c880fd5b8 class=collapsible-menu><li data-nav-id=/chapter3/1-allocation/index.html><a class=padding href=../../chapter3/1-allocation/index.html>Allocation dynamique üéá<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-id=/chapter3/2-lifespan/index.html><a class=padding href=../../chapter3/2-lifespan/index.html>Dur√©e de vie ‚è≥<i class="fa-fw fas fa-check read-icon"></i></a></li><li class=active data-nav-id=/chapter3/3-storage/index.html><a class=padding href=../../chapter3/3-storage/index.html>Espace de stockage üíæ<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-id=/chapter3/4-references/index.html><a class=padding href=../../chapter3/4-references/index.html>Usage des r√©f√©rences üîÄ<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-id=/chapter3/5-ownership/index.html><a class=padding href=../../chapter3/5-ownership/index.html>Ownership üèòÔ∏è<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-id=/chapter3/test/index.html><a class=padding href=../../chapter3/test/index.html>Questionnaire ‚òë<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/chapter4/index.html><a class=padding href=../../chapter4/index.html><b>4- </b>H√©ritage<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-48065e8b6e7e69533ca73b3931c8a0a1 class=collapsible-menu></ul></li><li data-nav-id=/chapter5/index.html><a class=padding href=../../chapter5/index.html><b>5- </b>Librairie standard<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-86528e6ba587b53932a1dafaa9cd375c class=collapsible-menu></ul></li><li data-nav-id=/chapter6/index.html><a class=padding href=../../chapter6/index.html><b>6- </b>Algorithmes<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-016ee40825ff7c4aeecbac08a8ca264b class=collapsible-menu></ul></li><li data-nav-id=/chapter9/index.html><a class=padding href=../../chapter9/index.html><b>7- </b>Templates<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-24ddf636ccd0ce3ef39c8060d1779332 class=collapsible-menu></ul></li><li data-nav-id=/chapter10/index.html><a class=padding href=../../chapter10/index.html><b>8- </b>Param√®tres de templates<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-66e6e0c58d73995ecc09e8fbbe358e51 class=collapsible-menu></ul></li></ul></div><div id=R-shortcuts><div class="nav-title padding">Acc√®s rapide</div><ul class=space><li><a class=padding href=https://github.com/Laefy/CPP_Learning_Code/><i class='fab fa-github'></i> D√©p√¥t Cours</a></li><li><a class=padding href=https://github.com/Laefy/CPP_Exercises/><i class='fab fa-github'></i> D√©p√¥t TPs</a></li><li><a class=padding href=../../slides/index.html><i class='far fa-file-powerpoint'></i> Slides</a></li><li><a class=padding href=../../workflow/index.html><i class='far fa-list-alt'></i> Workflow</a></li><li><a class=padding href=../../faq/index.html><i class='fas fa-question-circle'></i> FAQ</a></li><li><a class=padding href=../../chapter0/6-tips/index.html><i class='fa fa-rocket'></i> Astuces</a></li><li><a class=padding href=https://godbolt.org/><i class='fas fa-cog'></i> Compiler Explorer</a></li><li><a class=padding href=https://en.cppreference.com/w/><i class='fas fa-passport'></i> CPP-Ref</a></li></ul></div><div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"></div><div id=R-menu-footer><hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"><div id=R-prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVisitedLinks"><ul><li id=R-select-language-container class=footerLangSwitch><div class="padding menu-control"><i class="fa-fw fas fa-language"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=R-select-language>Langue</label>
<select id=R-select-language onchange="location=this.querySelector(this.value).dataset.url"><option id=R-select-language-fr value=#R-select-language-fr data-url=../../chapter3/3-storage/index.html lang=fr selected>Fran√ßais</option></select></div><div class=clear></div></div></li><li id=R-select-variant-container class=footerVariantSwitch><div class="padding menu-control"><i class="fa-fw fas fa-paint-brush"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=R-select-variant>Th√®me</label>
<select id=R-select-variant onchange=window.variants&&variants.changeVariant(this.value)><option id=R-select-variant-mine value=mine selected>Mine</option></select></div><div class=clear></div></div><script>window.variants&&variants.markSelectedVariant()</script></li><li class="footerVisitedLinks showVisitedLinks"><div class="padding menu-control"><i class="fa-fw fas fa-history"></i>
<span>&nbsp;</span><div class=control-style><button onclick=clearHistory()>Supprimer l'historique</button></div><div class=clear></div></div></li></ul></div><div id=R-footer class="footerFooter showFooter"><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></div></aside><script src=../../js/clipboard.min.js?1729268597 defer></script><script src=../../js/perfect-scrollbar.min.js?1729268597 defer></script><script src=../../js/theme.js?1729268597 defer></script><button id=footer-question-btn title="Envoyer un message √† propos du texte s√©lectionn√©" onclick=openQuestionForm() disabled><i class="fas fa-question-circle"></i></button><div id=footer-question-window disabled><form id=question method=POST action=https://formsubmit.co/3aa0f379a1aed9c454634cc2da153a7b target=question-submitted onsubmit=cleanQuestionFormContent()><input type=email name=email placeholder=mon_email@smthg.com required onchange=updateQuestionFormSubject()>
<textarea name=question rows=7 cols=30 placeholder="Mon message..."></textarea>
<input type=hidden name=selection>
<input type=hidden name=_replyto>
<input type=hidden name=_subject>
<input type=hidden name=_template value=box>
<input type=hidden name=_captcha value=false>
<input type=hidden name=_next value=//question-submitted/>
<input type=submit disabled style=display:none aria-hidden=true>
<input type=submit value=Envoyer></form><iframe class=hidden name=question-submitted src></iframe></div><script>function updateQuestionFormSubject(){let e=document.querySelector('#question>input[name="email"]').value;document.querySelector('#question>input[name="_subject"]').value="[C++][Chapitre 3] "+e+", retour sur ta question"}function cleanQuestionFormContent(){function e(e){e.value=e.value.replace(/\[\.\./g,"[ ..")}e(document.querySelector('#question>textarea[name="question"]')),e(document.querySelector('#question>input[name="selection"]'))}function openQuestionForm(){document.getElementById("footer-question-window").removeAttribute("disabled");var e=window.getSelection().toString();document.querySelector('#question>input[name="selection"]').value=e}function updateQuestionWidgetState(e){var t=document.getElementById("R-body-inner"),n=window.getSelection(),s=document.getElementById("footer-question-window");document.getElementById("footer-question-btn").disabled=n.isCollapsed||t==null||t.contains(n.anchorNode)==!1||t.contains(n.focusNode)==!1,e!==void 0&&e.type=="mouseup"&&s.contains(e.target)==!1&&s.contains(document.activeElement)==!1&&s.setAttribute("disabled",!0)}updateQuestionFormSubject(),document.onmouseup=document.onkeyup=document.onselectionchange=updateQuestionWidgetState,updateQuestionWidgetState()</script></body></html>